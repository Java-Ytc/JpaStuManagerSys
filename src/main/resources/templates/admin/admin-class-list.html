<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org" lang="zh-CN">
<head>
  <meta charset="UTF-8">
  <title>管理员班级列表</title>
</head>
<body>
<h1>管理员班级列表</h1>
<a href="/admin/classes/add">添加新班级</a>
<form action="/admin/classes" method="get">
  <label for="classCode">班级编号:</label>
  <input type="text" id="classCode" name="classCode" th:value="${param.classCode}">
  <label for="className">班级名称:</label>
  <input type="text" id="className" name="className" th:value="${param.className}">
  <button type="submit">查询</button>
</form>
<form action="/admin/classes/delete" method="post">
  <table>
    <thead>
    <tr>
      <!-- 添加一个全选的复选框，能够选中全部的数据 -->
      <th>
        <label for="selectAll">全选</label>
        <input type="checkbox" id="selectAll"/>
      </th>
      <th>班级编号</th>
      <th>班级名称</th>
      <th>学生数量</th>
      <th>操作</th>
    </tr>
    </thead>
    <tbody>
    <tr th:each="clazz : ${classes}">
      <td>
        <label th:for="${'checkbox_' + clazz.classCode}">选择</label>
        <input type="checkbox" id="${'checkbox_' + clazz.classCode}" name="classCodes" th:value="${clazz.classCode}"/>
      </td>
      <td th:text="${clazz.classCode}"></td>
      <td th:text="${clazz.className}"></td>
      <td th:text="${clazz.students != null && !clazz.students.isEmpty() ? clazz.students.size() : '没有学生'}"></td>
      <td>
        <a th:href="@{/admin/classes/edit/{classCode}(classCode=${clazz.classCode})}">编辑</a>
      </td>
    </tr>
    </tbody>
  </table>
  <button type="submit">删除选中项</button>
</form>
<div>
  <a th:href="@{/admin/classes(page=${currentPage - 1})}" th:if="${currentPage > 0}">上一页</a>
  <a th:href="@{/admin/classes(page=${currentPage + 1})}" th:if="${currentPage < totalPages - 1}">下一页</a>
</div>
<script>
  document.getElementById('selectAll').addEventListener('change', function () {
    // 通过 classCode 选中全部的数据
    const checkboxes = document.querySelectorAll('input[name="classCodes"]');
    checkboxes.forEach((checkbox) => {
      checkbox.checked = this.checked;
    });
  });
</script>
</body>
</html>